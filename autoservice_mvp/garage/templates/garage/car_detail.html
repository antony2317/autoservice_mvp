{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'garage/css/car_detail.css' %}">
{% endblock %}

{% block content %}
<div class="car-detail-container">
    <h2>{{ car.brand }} {{ car.model }}</h2>
    <p class="car-meta">–ì–æ–¥: {{ car.year }} | –ü—Ä–æ–±–µ–≥: {{ car.mileage }} –∫–º</p>

    <h3>–ò—Å—Ç–æ—Ä–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</h3>

    {% if service_history %}
    <ul class="service-history">
        {% for record in service_history %}
        <li>
            <div class="record-header">
                <div>
                    <strong>{{ record.date }}</strong> - {{ record.service_type }}
                    {% if record.garage %}<em>({{ record.garage.name }})</em>{% endif %}
                </div>
                {% if record.created_by == user or user.is_staff %}
                <div class="record-actions">
                    <a href="{% url 'edit_service_record' pk=record.id %}" class="btn-edit">‚úèÔ∏è</a>
                    <a href="{% url 'delete_service_record' pk=record.id %}" class="btn-delete">üóëÔ∏è</a>
                </div>
                {% endif %}
            </div>
            <p>{{ record.description }}</p>
            {% if record.cost %}<span class="cost">{{ record.cost }} ‚ÇΩ</span>{% endif %}
            <small class="record-meta">–î–æ–±–∞–≤–ª–µ–Ω–æ: {{ record.created_by.username|default:"–°–∏—Å—Ç–µ–º–∞" }}</small>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p class="no-records">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ–± –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏</p>
    {% endif %}

    <div class="button-group">
        <a href="{% url 'add_service_record' car.id %}" class="btn">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</a>
        <a href="{% url 'garage' %}" class="btn">–ù–∞–∑–∞–¥</a>
    </div>
</div>
{% endblock %}