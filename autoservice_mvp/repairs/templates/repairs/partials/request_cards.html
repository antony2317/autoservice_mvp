{% for req in requests %}
<div class="request-card" id="request-{{ req.id }}">
  <div class="request-header">
    <span class="request-user">{{ req.user.get_full_name|default:req.user.username }}</span>
    <span class="request-date">{{ req.created_at|date:"d.m.Y H:i" }}</span>
  </div>
  <div class="request-body">
    <p><strong>Авто:</strong>
      {{ req.car.base_car.brand }}
      {{ req.car.base_car.model }}
      {% if req.car.base_car.generation %}{{ req.car.base_car.generation }}{% endif %}
      ({{ req.car.year }})
      {% if req.car.engine_type == 'electric' %}
        — {{ req.car.get_engine_type_display }}
      {% elif req.car.engine_volume %}
        — {{ req.car.engine_volume }} л, {{ req.car.get_engine_type_display }}
      {% endif %}
    </p>
    {% if req.category %}<p><strong>Категория:</strong> {{ req.category.name }}</p>{% endif %}
    {% if req.repair_type %}<p><strong>Тип ремонта:</strong> {{ req.repair_type.name }}</p>{% endif %}
    {% if req.description %}<p><strong>Описание:</strong> {{ req.description }}</p>{% endif %}

    <form method="post" action="{% url 'repairs:respond_to_request' req.id %}" class="response-form">
      {% csrf_token %}
      <div class="form-group">
        <label>Цена (₽)</label>
        <input type="number" name="proposed_price" required min="1" step="0.01" class="form-control">
      </div>
      <div class="form-group">
        <label>Дата ремонта</label>
        <input type="date" name="proposed_date" required min="{{ today|date:'Y-m-d' }}" class="form-control">
      </div>
      <button type="submit" class="submit-btn">Отправить предложение</button>
    </form>
  </div>
</div>
{% empty %}
<div class="no-requests">
  <i class="fas fa-check-circle"></i>
  <p>Нет заявок по выбранным фильтрам</p>
</div>
{% endfor %}
